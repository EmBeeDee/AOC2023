package net.snowtiger.aoc

import scala.collection.mutable

/**
 * @author mark
 */

object AOC13
{
	val input = "#.##..##.\n..#.##.#.\n##......#\n##......#\n..#.##.#.\n..##..##.\n#.#.##.#.\n\n#...##..#\n#....#..#\n..##..###\n#####.##.\n#####.##.\n..##..###\n#....#..#"
	val input1 = "#..#.##.#..\n###.####.##\n###.####.##\n###.####.##\n###.####.##\n#..#.##.#..\n.#..#..#..#\n..#.####.#.\n####....###\n..#......#.\n.#.........\n#...#..#...\n####....###\n.##......##\n#...####...\n###.#..#.##\n#.########.\n\n..#....#.\n..######.\n..###.##.\n####..###\n...####..\n###.##.##\n##.####.#\n...#..#..\n..######.\n\n.##......##...#\n..########....#\n##.#....#.####.\n.#...##...#..#.\n.##.####.##..##\n#.###..###.##.#\n....#..#.......\n.....##........\n##..#..#..####.\n...#.##.#......\n.##########..##\n#.##....##.##.#\n.#..####..#..#.\n\n####..#.#####\n.#.#.#.#.##..\n..#.##....#.#\n#...#..##....\n###.####.#.#.\n..#....#.#..#\n..#....#.#..#\n###.####.#.#.\n#...#..##....\n..#.##....#.#\n.#.#.#.#.###.\n####..#.#####\n####..#.#####\n\n.##.####.##.#\n#..#.##.#..##\n...#.##.#....\n#..#....#..#.\n#..#....#..#.\n...#.##.#....\n#..#.##.#..##\n.##.####.##.#\n.##########.#\n####....####.\n#.#......#.#.\n.##.####.##..\n..####.###..#\n\n...#..##..#\n#....####..\n.#.##.##.##\n.#.##.##.##\n#....####..\n...#..##..#\n##.##....#.\n####.####.#\n#.#..####..\n\n...#..##..#..\n..#..####..#.\n...###..###..\n..##.####.##.\n..##......##.\n....######...\n..##.....###.\n######..#####\n.....#..#....\n##.#.#..#.#.#\n...#......#..\n....##..##...\n..#.######.#.\n##.#.####.#.#\n...##.##.##..\n##.#..##..#.#\n..####..####.\n\n#.#..##..#.##\n.##.#..#.##..\n##..####..###\n.#..#..#..#..\n..#.#....#...\n.#.#.##.#.#..\n##..####..###\n\n#.#..#.#.#.\n##.....#..#\n#.#.####..#\n...#...###.\n##....###..\n#.#.#.....#\n.##..#..###\n.##..#..###\n#.#.#.....#\n##....###..\n...#...###.\n#.######..#\n##.....#..#\n#.#..#.#.#.\n#.#..#.#.#.\n\n##.##.#.######.\n....##.........\n......##.####.#\n....####......#\n..##.#.#.#..#.#\n.###...#.####.#\n###.#.##......#\n....###..#..#..\n...##.##.#..#.#\n..##.##.##..##.\n..#..#.#.#..#.#\n##.#..###....##\n..##..#........\n..#.#..........\n##.#.#.#..##..#\n#####..........\n....#.....##...\n\n#....##......##..\n########.##.#####\n#.##.##..##..##.#\n#....#.######.#..\n.#..#.##.##.##.#.\n.#..#.##....##.#.\n.####..##..##..##\n.#..#.#.####.#.#.\n#.##.##...#..##.#\n#######.#..#.####\n##..###.#..#.###.\n#....##.####.##..\n.#..#...#..#...#.\n\n....#..##\n..#.#..##\n..#.#.##.\n..#.#..#.\n.......#.\n#.....#.#\n.#.######\n.####..#.\n.####..#.\n.#.######\n#.....#.#\n.......#.\n..#.#..#.\n..#.#.##.\n..#.#..##\n....#..##\n.##.###.#\n\n#.##..#..####\n..#..###.#.#.\n.##.#.#..##.#\n#...#..###...\n#...#..###...\n.##.#.#..##.#\n..#..###.#.#.\n#.##..#..####\n###.#.###..##\n.#.#....###.#\n##..##....##.\n##..##....###\n.#.#....###.#\n###.#.###..##\n#.##..#..####\n..#..###.#.#.\n.##.#.#..##.#\n\n####.#.........\n####.##..#..#..\n....##.#..##..#\n.....#..#....#.\n.##.#...#....#.\n########..##..#\n#..###...#..#..\n.##.......###..\n#..###.###..###\n#..#.#.#..##..#\n....##..##..##.\n.##.##.#..##..#\n####.#...####..\n\n#.#.######.\n.##.#....#.\n##.########\n.##.#.##.#.\n.##.#.##.#.\n##.########\n.##.#....#.\n#.#.######.\n...#..##..#\n.#..#..#.#.\n.##.#....#.\n\n###...##..##...##\n##.#..........#.#\n###.#.##..##.#..#\n..#...######...#.\n..##.##....##.##.\n####.#.####.#.###\n...#.#.#..#.#.#..\n..##.##....##.##.\n####..##..##..###\n...##..#..#..##..\n..###...##...###.\n\n##.##....##...#\n.####....####..\n#####....####..\n#...####.#.....\n#..##..####...#\n#..##......##..\n.##...##..#..##\n#.#...#.#.#..##\n..##.#..####...\n..##.#..####...\n#.#...#.#.#..##\n.##...##..#..##\n#..##......##..\n#..##..####...#\n#...####.#.....\n#####....####..\n.####....####..\n\n..#########..\n#...##...#..#\n#...#.#......\n.##..##..#...\n.##....##...#\n..#..##.##..#\n..#..##.##..#\n.##....##...#\n.##..##..#...\n#...#.#......\n#...##...#..#\n..#########..\n.#.......####\n#.#.##.#....#\n....###......\n.......##...#\n.......##.#.#\n\n#..#.#..####..#.#\n###.#.#......#.#.\n..####..#..#..###\n###.#.#.#..#.#.#.\n..##..#......#..#\n...#..######.#..#\n##.#..#.#..#.#..#\n.##....######....\n.####...####...##\n#######......####\n##....##.##.##...\n#.####...##...###\n#.####...##...###\n\n....#..\n###.##.\n#.###..\n.#.#.##\n.#.#.##\n#.###..\n###.##.\n....#.#\n.#.#..#\n.#.#..#\n....#.#\n\n##..######.#.#.\n##..######.#.##\n..##...#..#.#.#\n#....#..###.#..\n#.##.#.#.####.#\n.#..#.##.#...#.\n..##..##.##..#.\n#....###...####\n#.##.######....\n#.##.#.#..#.#.#\n##..##.##.#####\n\n.####...#.#..#.\n.##.#..##.##..#\n.####..##.##..#\n.####...#.#..#.\n###.#.#.###....\n#.#..#.###..###\n#.#..##..#.##..\n....#..#..#.##.\n#.#.#..#.##.#.#\n#.#.#..#.##.#.#\n....#..#..#.##.\n#.#..##..#.##..\n#.#..#.###..###\n###.#.#.###....\n.####...#.#..#.\n\n##.....\n##.....\n#..####\n#..#.#.\n#.#..#.\n.#..##.\n.#..##.\n#.#..#.\n#..#.#.\n#..#.##\n##.....\n\n###.#.###......\n.##..#.....#...\n.#.#..#.#...###\n##.###.#####...\n#....#......###\n#...####.#..#..\n....###.###.#..\n#.####.##.##.##\n#.####..#.##.##\n....###.###.#..\n#...####.#..#..\n#....#......###\n##.###.#####...\n\n#..##.#..####..#.\n#...#.#..####..#.\n..#.......##.....\n.#####..........#\n##..#............\n.#.#.#..........#\n##..##..........#\n.##.#.##########.\n.#.#....#....#...\n##.##.###.##.###.\n##.#.####....####\n.#.#.##.######.##\n###.#.#.######.#.\n.#.#.#.########.#\n##.##.#.##..##.#.\n\n###.##.#..#.#\n..####..###..\n###...#..##.#\n##.#..##.#.##\n##.#..##.#.##\n###...#..##.#\n..####..###..\n###.##.#..#.#\n##.##.#.#..#.\n..##..##.....\n...#..##.....\n........##..#\n##...#.#.#..#\n.##.##.#.#.#.\n###...###..#.\n###.##.##..#.\n##.#....#.#..\n\n#..#...####\n#..##.#####\n.#.....####\n##..#.#####\n#..#.##....\n.#.####....\n#.##.##....\n.###.#.####\n#..#.##....\n##...##....\n#...##.....\n..##..##..#\n..#........\n#.##.##....\n.##.#.#####\n\n#.#...##.##.#\n..#..####..##\n#####....##..\n#####....##..\n.....####..##\n#.#...##.##.#\n#.#####......\n.#.##.#######\n##..#.#.####.\n###.##..#..#.\n....##..####.\n##.##........\n#..#..###..##\n#.##..#..##..\n#####..##..##\n\n####.#.#.#..###\n.#..#.##..#..#.\n##.##.#.##....#\n#..##.#.#.....#\n#..###..#....#.\n#..###..#....#.\n#..##.#.#.....#\n##.##.#.##....#\n.#..#.##..#..#.\n####.#.#.##.###\n..#.#.#.##.#...\n..#.#.#.##.#...\n####.#.#.##.###\n.#..#.##..#..#.\n##.##.#.##....#\n\n#.#...#.##..#.#\n....###..####.#\n.###.#.#####...\n.###.#.#####...\n....###..####.#\n#.#...#.###.#.#\n...#..#.#.#....\n..###....#.#.#.\n##..##.#....###\n##..##.#....###\n..###....#.#.#.\n...#..#.#.#....\n#.#...#.###.#.#\n....###..####.#\n.###.#.#####...\n\n##.#.#...#..####.\n..#.###...#......\n...###....#.#..#.\n..####..#.##....#\n##..#....##.####.\n##.#....#...#..#.\n###.....##.##..##\n##.####.#.###..##\n..##..#...#.####.\n......#.#.##....#\n##.#..#..#.#.##.#\n.....#.#...##..##\n....###....#....#\n#.#.###..##.####.\n##.######...####.\n\n.####..#.##\n.#####.####\n.#.###.####\n.####..#.##\n.#......#.#\n..#...#..##\n#..###.##..\n##..#..####\n#####.#.#..\n###..#.####\n.###.#....#\n.###.#....#\n###..#.####\n#####.#.#..\n##..#..####\n\n...#######.##...#\n..#.#..#.#.#####.\n##..####..#...##.\n##..####..#...##.\n..#.#..#.#.#####.\n...#######.###..#\n..#.#...#..#..#.#\n..#.##.....#.##..\n##.##..##..##..##\n.....#####...#.#.\n..#.###.#.##.##..\n..#...##.##..##.#\n..#..#.##...###..\n\n#..#.#.###...##\n#.##...#.###..#\n.#.############\n.##.....#...###\n##.....#...#.#.\n...##....#.#..#\n..#.....#.#.#..\n..#.....#.#.#..\n..###....#.#..#\n##.....#...#.#.\n.##.....#...###\n.#.############\n#.##...#.###..#\n#..#.#.###...##\n#..#.#.###...##\n\n.#.##.#....####..\n#......#.########\n###..####...##...\n#..###.###......#\n.##..##....#..#..\n.#....#.#.#....#.\n#.####.#....##...\n\n##.##..##..\n##.##..##..\n...#.######\n##..##..##.\n.#.....#...\n.#.######.#\n.##....##.#\n.##....##.#\n.#.######..\n.#.....#...\n##..##..##.\n...#.######\n##.##..##..\n\n..##...#..#....#.\n..#.....##.....#.\n..#..##.##.##..#.\n..#...##..##...#.\n#####..#..#..####\n..#..#......#..#.\n...##........##..\n####..##..##..###\n..#..#.####.#..#.\n\n...##....#.\n.....#.#..#\n....#...#.#\n########...\n..####.##..\n.#####...##\n###.###.##.\n###.###.##.\n.###.#...##\n..####.##..\n########...\n....#...#.#\n.....#.#..#\n...##....#.\n##..#.#####\n.......##.#\n.......##.#\n\n.#...#...###.#.##\n##...#####.#.##..\n.####....##.###..\n##.#..##.###..#..\n#.##.##.##....##.\n#.###..#...##..##\n..##..#######..##\n..##..#######..##\n#.###..#...##..##\n#.##.##.##....##.\n##.#..##.###..#..\n.####....##.####.\n##...#####.#.##..\n.#...#...###.#.##\n.#...#...###.#.##\n##...#####.#.##..\n.####....##.####.\n\n#####....##\n##.##.##.##\n..#.#.#..#.\n..#..####..\n..###.##.##\n...#.####.#\n####......#\n##.#.#..#.#\n####......#\n###.######.\n...#..##..#\n##.........\n..##..##..#\n....#.##.#.\n####.#..#.#\n\n#.######.######\n.##....##.####.\n.#..##..#.####.\n##..##..###..##\n#..#..#..######\n##..##..##....#\n###....########\n.#.####.#......\n#.#....########\n###....###....#\n##.####.##....#\n\n##########..#..\n.######.####...\n.#.##.#.###.###\n.######...#.#..\n#..##..#.#....#\n##....##.##.###\n#..##..#.###..#\n#..##..#.#.###.\n#..##..#.#.###.\n#..##..#.###..#\n##....##.##.###\n#..##..#.#....#\n.######...###..\n.#.##.#.###.###\n.######.####...\n\n...#####.##.#####\n...#####.##.#####\n...#..#.#..#.#..#\n#...#..#....#..#.\n####.####..####.#\n#.#....#.##.#....\n##.#...######.#.#\n\n#####..####\n###.###....\n.......####\n....#######\n..#.###....\n.#.#..#....\n.######....\n#....#..##.\n.#..###....\n.###.##....\n#####.#####\n#.#....####\n###.#.#....\n..##.#.....\n.#..#..####\n\n..#..#.\n#####.#\n..#.##.\n#####..\n..###.#\n......#\n##..#..\n###..##\n######.\n#####..\n###..##\n\n......#...##.#.\n#####.##.####..\n...#.#.####.##.\n...#.#.####.##.\n#####.##.#####.\n......#...##.#.\n##.#.#.##..#..#\n...#..#.#....#.\n#...##.#.##..#.\n.#...#..#.#####\n.....###.##.##.\n.....###.##.##.\n.#...#..#.#####\n\n..#.##.#..#.#\n##...........\n##.##.#....#.\n..#.....##...\n...#.##....##\n..###.#....#.\n##.#..######.\n....###...###\n##.####.##.##\n####..#....#.\n.....#......#\n\n.##.##.####.#\n##..####..###\n.#..###.##.##\n##.#..#.##.#.\n#.##.#.####.#\n.##.....##...\n####.........\n.###.###..###\n.#...#..##..#\n..#....#..#..\n###.#.#....#.\n.#..####..###\n##..####..###\n\n.##....#.##\n.##.#.#.###\n#####.##.##\n....###.#..\n.##..#..#..\n#.###..#...\n#..#.###...\n.##..#..###\n######.....\n\n###..##..##..\n..##.###....#\n#..#..#.#..#.\n..###.#..##..\n.#...##.#..#.\n.#...##.#..#.\n..###.#..##..\n#..#..#.#..#.\n..##.###....#\n.##..##..##..\n..##.........\n..##.##.#..#.\n##.#...######\n....#########\n....#...#..#.\n\n.#.#..#.#...#\n..##..##....#\n..##..##....#\n.#.#..#.#..##\n##..##..###..\n............#\n#.##..##.##..\n.#.#..#.#..#.\n#..####..#.#.\n..#....#...##\n.#......#.##.\n\n.#...#.##\n#..#.##..\n#..#..###\n#..#...##\n######.##\n#####....\n#..##.#..\n.##...#..\n######.##\n.##....##\n....#####\n....##...\n.##.##...\n.......##\n#######..\n.##.#.#..\n######.##\n\n.####..##..##\n.#..#.####.#.\n.####.#..#.##\n#....#.##.#..\n#....#....#..\n.####.####..#\n..##........#\n..##..#..#..#\n.#..#......#.\n#....######..\n######.##.###\n\n###..###..#....\n.##..##.....##.\n##.##.###.#.##.\n........#......\n#.#..#.#..#####\n.#.##.#.#...##.\n..####....#.##.\n##....###.#....\n..#..#...######\n..#..#...#.....\n..#..#..##..##.\n...##...##.#..#\n.######.#......\n#########.####.\n.#.##.#.##.####\n##.##.##.......\n##....##.##.##.\n\n######..#\n...#.###.\n.#.....##\n.#.....##\n...#.##..\n######..#\n######..#\n\n...#.#...#...\n...#.#...#...\n###.###.#.##.\n....#.####.##\n.....##..#..#\n##..#..##..##\n....##....##.\n..##......###\n##...#...#..#\n#....#.##....\n#....#.#.....\n\n###..#.#..#\n...#.##..##\n##..#..##..\n##.#....##.\n###..#...##\n..##..###..\n..#.....#..\n...##.##..#\n..####..##.\n.....#.##..\n..###.#.#..\n..#.#.#..##\n..#.#.#..##\n..###.#.#..\n....##.##..\n\n.....##..#.\n#..#.#...##\n....###..##\n.....####..\n.##.##.#.##\n.....#.###.\n.....#....#\n#..##...###\n####...####\n####.#....#\n######..###\n#..##.##.##\n#####..####\n#####..#..#\n#####..#.##\n\n#.....###.#\n#.###...#..\n#.###...#..\n#..#..###.#\n##.##.#..#.\n#####.#...#\n.#.###.####\n#.##.###...\n..#..#..#..\n.#...##.#..\n.#...##.#..\n..#..#..#..\n#.##.###...\n.#.###.####\n#####.#...#\n##.##.#..#.\n#..#..###.#\n\n...#..#.#..\n##.##....##\n..#..##.###\n.....#.#.##\n..##...####\n##.....#..#\n####..#.##.\n...#.###...\n##...#..###\n###.###.#.#\n##..##.##..\n..#...#.#.#\n..#..##..#.\n..#.#..#...\n..#.#..#...\n..#...#..#.\n..#...#.#.#\n\n....#..#.#..##.\n####.#.#....###\n#..#.###.#...#.\n.##.####.####..\n.......#.....##\n#..#..##..#.#..\n####....##..#.#\n....##....##.#.\n####.#.#...####\n#..#.#.####.###\n#######.#.#####\n####.#..###..##\n####.#..###..##\n#######.#.#####\n#..#.#.########\n####.#.#...####\n....##....##.#.\n\n.#..##....#.###\n#..##.#..##.#..\n##.##.#..##.#..\n.#..##....#.###\n###.###.##.#..#\n.#..##.##..###.\n##.#.##.####...\n##.#.##.####...\n.#..##.##..###.\n###.###.##.#..#\n.#..##....#.###\n##.##.#..##.#..\n#..##.#..##.#..\n.#..##....#.###\n#.#..###..###.#\n#.###.#..#.##.#\n.##..#.#...#..#\n\n..#......\n...#.....\n..#.#..##\n...###.##\n...###.##\n..#.#..##\n...#.....\n..#......\n##.#####.\n##...#..#\n.#..#....\n##.#...##\n###.##.#.\n...###..#\n......#..\n.....#..#\n...##..#.\n\n...#...#..##..#.#\n......#..###...##\n#.##.####.####.##\n.######.#....#...\n...###.##..#....#\n...###.##..#.....\n.######.#....#...\n#.##.####.####.##\n......#..###...##\n...#...#..##..#.#\n....#...##..###.#\n..#.###.##......#\n..#.###.##......#\n\n###.####....#\n...##.#.#..#.\n###..#...##..\n..#.#########\n.###.#..#..#.\n#.#..........\n.#.##.#.####.\n....###..##..\n..#.#..#....#\n..#.#..#....#\n....###..##..\n.#.##.#.####.\n###..........\n\n##..#...###..\n.####.#..#.##\n..##...#..###\n..##....###..\n........#####\n##..####.....\n#######......\n#....###...##\n#######.#####\n#######.###..\n..##..###..##\n######.......\n..##...###.##\n.####.##...##\n..##....##...\n#.##.#.....##\n.#..#.#.#####\n\n#####.#.#\n#.#.##...\n#.#.##...\n#####.#.#\n##.######\n###..##.#\n...####..\n..#.###..\n..#.##...\n\n....##.###.\n####.......\n#..#.....#.\n....#.####.\n#..####.###\n#..##...#.#\n#..##.#.#.#\n\n####..###...###\n######.....##..\n######.#.#..#.#\n######.##.#.##.\n#####....#...#.\n.....#.##.###..\n....#..####.##.\n#######.##.....\n#####.##.#.#.#.\n......#..#..#..\n####.#..#.##...\n....#....#....#\n..........##...\n####..###....#.\n#..#####.#.....\n\n.#.##...#......\n#.#..#..#......\n....#.#..######\n.#..#.#..######\n#.#..#..#......\n.#.##...#......\n..##.#.#.#.##.#\n#...#..#.#....#\n..#.#.#.##.##.#\n\n######.#.##.#..\n....####.#.#.#.\n##.#.#..#.###..\n..###.#....###.\n..#..#.....##.#\n##.#.###....#.#\n..##.#.#.......\n...##..####.##.\n...####..#.##..\n###.#####.###..\n#########.###..\n...####..#.##..\n...##..####.##.\n..##.#.#.......\n##.#.###....#.#\n\n.#.######...#.###\n...#....#...##...\n##.#....#.###.#..\n#.#.####.#.#.####\n#..........#...##\n..#.####.#..###.#\n#..........#.#...\n#...#..#...#..##.\n###..##..######.#\n#.##....##.##.###\n.##.####.##.#.#.#\n.....##.....#..##\n#..#.##.#..#.##.#\n#..#.##.#..#.##.#\n.....##.....#..##\n\n##..#####.#.#\n####...#.#.##\n####...#.#.##\n##..#######.#\n..##..#######\n##..#........\n##.###....#.#\n##....####.#.\n..###...#####\n###.#####.###\n...#.####.#..\n##.##...#...#\n..#..##....##\n...##...###.#\n..##.#...#.#.\n##.###.#..##.\n####..##..#..\n\n.##.###.#.##.#..#\n.##...#..##.#####\n####...#...#..##.\n####.......######\n#.##.##.###.#.##.\n....##.####..####\n......#..########\n.....#.###..#.##.\n.##.#..#######..#\n.##......###..##.\n.....###.##.##..#\n####....#..#.#..#\n####...#.#.#.....\n#..#....#..######\n....##.##.###.##.\n#..###.#...##.##.\n.##.#...#########\n\n..####...#.#..#\n########.......\n#......##.##.##\n##....##..#.##.\n.#.##.#.....###\n#.####.###.####\n#.####.#####..#\n##....###.#.##.\n........###.###\n#########...#..\n#########......\n\n########.####\n#.#..#.#.....\n...##....####\n###..###.#..#\n.#.##.#.#.##.\n#......###.##\n########.....\n##.##.##..##.\n###..###.####\n\n#######...#....\n.##..#..##.#..#\n#..######.#####\n#..#...#.##...#\n.....#..##...##\n.##.#....#..#.#\n.....##.#....##\n.##...#...#...#\n.##...#...#...#\n.....##.#....##\n.##.#....#..#.#\n.....#..##..###\n#..#...#.##...#\n#..######.#####\n.##..#..##.#..#\n\n.###...\n##....#\n##.#..#\n.###...\n...####\n.#..#..\n##....#\n#####.#\n.##..##\n...##.#\n.#.....\n.#.....\n...##.#\n.##..##\n#####.#\n##....#\n.#..#..\n\n#..#....#..##\n#..#....#..##\n.#........#.#\n.#.##..##.#..\n.##.#..#.#..#\n..#.#..#.#..#\n#####..#####.\n#.########.#.\n.#.##..##.#.#\n\n#.##..##.\n....#....\n....#....\n#.#...##.\n.##.###..\n##..#..##\n##..#..##\n\n.##...##...\n##.##....##\n#..########\n#..########\n#####....##\n.##...##...\n....##..##.\n..#..#..#..\n#..########\n#.#........\n.###..##..#\n#...######.\n..#..####..\n\n#..#...#.###...#.\n#....###.#..#..##\n..###.##.#...#...\n..##.####..#..###\n.#..###...##.####\n#..####.##.##.#.#\n##.####.##.##.#.#\n.#..###...##.####\n..##.####..#..###\n..###.##.#...#...\n#....###.#..#..##\n#..#...#.###...#.\n#..#...#.###...#.\n#....###.#..#..##\n..###.##.#...#...\n..##.####..#..###\n.#..###...##.####\n\n##.....#.\n##.....#.\n.....##.#\n##...#.##\n#........\n.#.....##\n...##....\n.##.#....\n.#....#.#\n.#....#.#\n.##.#....\n...##....\n.#.....##\n#........\n##...#..#\n.....##.#\n##.....#.\n\n##.#..##.#..#.##.\n.#.##.#.#.##.#.#.\n##.#####..##..###\n#.#.####.####.###\n###.#.#.#.##.#.#.\n...###..#.##.#..#\n#..#.###.#..#.###\n#..#.###.#..#.###\n...###..#.##.#..#\n###.#.#.#.##.#.#.\n..#.####.####.###\n\n##..#......##\n##.#.#.....#.\n#.#####.##.##\n#.#####.##.##\n##.#.#.....#.\n##..#......##\n#..#...##..#.\n#..##...##...\n..###.#.#.##.\n..###.#.#.##.\n#..##...##...\n#..#...##..#.\n##..#.#....##\n##.#.#.....#.\n#.#####.##.##\n\n.##..####..##.###\n##.#..##..#.##.##\n##.#......#.#####\n.##..####..##.###\n..#.##..##.#..#..\n##.##.##..#.#####\n#.##..##..##.#...\n\n#.##..#..##....\n.#.##.#.#######\n...#...#.#..###\n...##.####...##\n#.##.#.##.#####\n#.##.#.########\n...##.####...##\n...#...#.#..###\n.#.##.#.#######\n#.##..#..##....\n##...####.###..\n\n#.####..##..#\n.....#.######\n.#.#.#.#.####\n##...##.#.##.\n##.##...#.##.\n..###..#.#..#\n#####.#.##..#\n..##..#..####\n.##......#..#\n.###.....#..#\n..##..#..####\n\n.##...#.####....#\n#..#..#.#....###.\n.#..####.##.#####\n#..###.##..#.#..#\n.##.#######..####\n.##.#######..####\n#..###.##..#.#..#\n\n###.##.#..#.#.###\n###.##.#..#.#.###\n.##.##..###..##..\n...#.####.##.##.#\n####.#.#..#.##...\n....####....#...#\n..###.##.#.#...##\n\n#####...##.##\n#..##.##..##.\n....##..#...#\n#.#####....#.\n....#....##..\n#..#..#...#..\n.##....######\n.##.###..####\n#..#.#...####\n........##.##\n.##.####..#..\n.##..##.###.#\n.##..##.###.#\n\n...#.....##...#.#\n...#.#.###....#..\n..##.###......#.#\n..##.###......#.#\n...#.#.###....#..\n...#.....##...#.#\n#...#..##.#...#..\n.####.######.....\n###.##....#.....#\n..##.#.###...#...\n####..#...#..##..\n..#.#####.###..##\n##..#...#....#...\n#######...###.#..\n#######...###.#..\n##..#...#....#...\n..#######.###..##\n\n####.#####.##.###\n..#..###..#.#####\n.#.#.####.##.#..#\n#.####..#....#..#\n.....#.#.#.###..#\n##..#.####.#..##.\n..#....#..####..#\n.####.#####.#.##.\n.####.#####.#.##.\n..#....#..####..#\n##..#.####.#..##.\n.....#.#.#.###..#\n#.####..#....#..#\n\n#...####.\n...#.##.#\n.#..#..#.\n#####..##\n.####..##\n.#..#..#.\n...#.##.#\n#...####.\n#...#..#.\n#.#.####.\n#.#######\n\n..##..#\n###....\n....##.\n..##..#\n....##.\n...####\n##..##.\n###..#.\n..#.##.\n...#..#\n..##..#\n...#..#\n##.####\n####..#\n..##..#\n\n###....#...##..\n..####..##....#\n.####..#.######\n####.#.#.#.##.#\n#####..####..##\n.###.####......\n#.#..#.##.#..#.\n#######..#.##.#\n..#..###.##..##\n.#.###.....##..\n#...#....######\n.###..#.#......\n...##.##.#.##.#\n...##.##.#.##.#\n.####.#.#......\n#...#....######\n.#.###.....##..\n\n#.#.###..#..#\n.##.###.#....\n#.###.#......\n....##....##.\n#.#.#..#.####\n...#.#....##.\n.#.##.#.#####\n...##.#.#####\n...#.#....##.\n\n..#.##.#..##..#\n#..#..######..#\n##..#..###.#..#\n###...##...#..#\n##.########....\n###...#.##.####\n..#...##.#..##.\n\n.##..##..##..\n####..#..#..#\n#..#..#..##.#\n.##.#......#.\n#######..####\n####...##...#\n.##....##....\n#..#...##...#\n.##.##....##.\n####.#.##.#.#\n....#..##..#.\n\n.##.###\n.##.###\n.######\n##...##\n#..#.#.\n.##....\n.##....\n#.#....\n...###.\n...###.\n#.#.#..\n.##....\n.##....\n#..#.#.\n##...##"

	def main(args: Array[String]): Unit =
	{
		val grids = input1.split("\\\n\\\n").map(extract).toList
		val refs = grids.map(_.reflections)
		refs.foreach(println)
		println("Total = "+refs.sum)
		println()
		val smudgedRefs = grids.map(_.smudgeReflections)
		smudgedRefs.foreach(println)
		println("Total = "+smudgedRefs.sum)
	}

	def extract(input: String): Grid = Grid(input.split('\n').toList)

	case class Grid(g: List[String]) {
		val h = g.size
		val w = g(0).size

		def reflections: Int = {
			val horiz = horizReflections
			if (horiz.size>2) throw new Exception("Oops too many horiz reflections: "+horiz)
			else if (horiz.size==1) horiz.head*100
			else {
				val vert = transpose.horizReflections
				if (vert.size>2) throw new Exception("Oops too many vert reflections: "+vert)
				else if (vert.size==1) vert.head
				else throw new Exception("No reflections!")
			}
		}

		def horizReflections: List[Int] = {
			(1 to h-1).flatMap(horizRef).toList
		}

		def horizRef(on: Int): Option[Int] = {
			val n = on.min(h-on)
			if ((0 until n).forall(i => g(on+i)==g(on-i-1))) Some(on)
			else None
		}

		def smudgeReflections: Int = {
			val unsmudged = reflections
			var smudged = Set[Int]()
			for (x <- 0 until w)
				for (y <- 0 until h)
					smudged++= smudgeReflections(x, y)
			smudged = smudged-unsmudged
			println(smudged)
			if (smudged.size!=1) throw new Exception(s"Smudging fail $smudged")
			else smudged.head
		}

		def smudgeReflections(x: Int, y: Int) = {
			val smudged = withSmudge(x, y)
			smudged.horizReflections.map(_*100) ++ smudged.transpose.horizReflections
		}

		def withSmudge(x: Int, y: Int): Grid = {
			def swapC(c: Char): Char = {if (c=='.') '#' else '.'}
			def swap(line: String): String = line.slice(0,x) + swapC(line(x)) + line.slice(x+1,w)

			Grid( g.slice(0,y) ++ List(swap(g(y))) ++ g.slice(y+1,h))
		}

		def transpose: Grid = Grid(g.map(_.toList).transpose.map(_.mkString))
	}

	def tokens(s: String): List[String] = s.split(' ').toList.map(_.trim).filter(_.size>0)


}